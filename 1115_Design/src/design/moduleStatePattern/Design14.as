package design.moduleStatePattern {import com.dell.alienFx.GlobalAnim;import com.dell.alienFx.SwatchAFX;import com.dpa.utils.tracers.traceProps;import com.greensock.TimelineLite;import com.greensock.TweenAlign;import com.greensock.TweenLite;import com.greensock.plugins.TintPlugin;import com.greensock.plugins.TweenPlugin;import com.kenergy.kevents.KsliderEvent;import design.calloutObserverPattern.abstract.AbstractCallOut;import design.calloutObserverPattern.observers.controls.abstract.Context_Button_ON_OFF;import design.calloutObserverPattern.subjects.ConcreteCallOutSubject;import com.greensock.events.LoaderEvent;import com.greensock.loading.SWFLoader;import flash.display.MovieClip;import flash.display.Sprite;import design.moduleStatePattern.abstract.Context_Modules;import design.moduleStatePattern.abstract.IState;import design.calloutObserverPattern.observers.CallOut;import design.calloutObserverPattern.observers.CallOutContainer;import utils.display.addChild;import utils.string.trim;//Stop State;public class Design14 implements IState {    private var modules:Context_Modules;    private var target:MovieClip;    private var data:Object;    private var callNumExpanded:int;    //LOADER VARS    private var observerSubjectVars:Object;    private var _swfRootAW14:MovieClip;    private var _swfRootAW17:MovieClip;    private var _swfRootAW18:MovieClip;    private var concreteSubject:ConcreteCallOutSubject;    private var _callOutParentContainer:Sprite;    private var _featureContainer14:Sprite;    private var _featureContainer17:Sprite;    private var _featureContainer18:Sprite;    private var _callOutContainer:Sprite;    private var _sliderAW14:Slider;    private var _sliderAW17:Slider;    private var _sliderAW18:Slider;    private var _btnOnOffAW14:Context_Button_ON_OFF;    private var _btnOnOffAW17:Context_Button_ON_OFF;    private var _btnOnOffAW18:Context_Button_ON_OFF;    private var _icons:MovieClip;    private var newState:int;    public function Design14(_modules:Context_Modules, _target:MovieClip, _data:Object, icons:MovieClip) {        TweenPlugin.activate([TintPlugin]);        this.data = _data;        this.modules = _modules;        this.target = _target;        _swfRootAW14 = _data.swfRootAW14;        _swfRootAW17 = _data.swfRootAW17;        _swfRootAW18 = _data.swfRootAW18;        _featureContainer14 = _data.featureContainerAW14;        _featureContainer17 = _data.featureContainerAW17;        _featureContainer18 = _data.featureContainerAW18;        _sliderAW14 = data.sliderAW14;        _sliderAW17 = data.sliderAW17;        _sliderAW18 = data.sliderAW18;        _btnOnOffAW14 = data.onOffAW14;        _btnOnOffAW17 = data.onOffAW17;        _btnOnOffAW18 = data.onOffAW18;        _icons = icons;        buildUI();    }    public function activateDesign14():void {//        trace("Your already in 14 state")    }    public function activateDesign17():void {        newState = 17;        modules.removeEventHandlers();        var delay:Number = GlobalAnim.TRANSISITION + .2;        var close:TimelineLite = new TimelineLite();        close.insertMultiple([            TweenLite.to(modules.coaw14Array[1], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[7], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[4], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[0], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[2], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[5], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[6], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[3], GlobalAnim.TRANSISITION, {alpha:0})        ],0, TweenAlign.NORMAL,.05)        //Slider switch        TweenLite.to(target.sliderAW14, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.sliderAW18, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.sliderAW17, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 1});        //ON OFF button switch        TweenLite.to(target.btnOnOffAW14, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.btnOnOffAW18, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.btnOnOffAW17, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 1});        //FEATURES        TweenLite.to(target.featureContainer14, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 0});        TweenLite.to(target.featureContainer18, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 0});        TweenLite.to(target.featureContainer17, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 1});        for (var i:int = 0, len:int = 7; i < len; i++) {            modules.coaw17Array[i].alpha = 0;            if (modules.coaw17Array[i].isExpanded) {                callNumExpanded = i;                modules.coaw17Array[i].close();            }        }        var open:TimelineLite = new TimelineLite({delay:delay, onComplete:onTimeLineComplete});        open.insertMultiple([            TweenLite.to(modules.coaw17Array[3], GlobalAnim.TRANSISITION, {alpha:1}),            TweenLite.to(modules.coaw17Array[6], GlobalAnim.TRANSISITION, {alpha:1}),            TweenLite.to(modules.coaw17Array[4], GlobalAnim.TRANSISITION, {alpha:1}),            TweenLite.to(modules.coaw17Array[2], GlobalAnim.TRANSISITION, {alpha:1}),            TweenLite.to(modules.coaw17Array[0], GlobalAnim.TRANSISITION, {alpha:1}),            TweenLite.to(modules.coaw17Array[5], GlobalAnim.TRANSISITION, {alpha:1}),            TweenLite.to(modules.coaw17Array[1], GlobalAnim.TRANSISITION, {alpha:1})        ],0, TweenAlign.NORMAL,.05)        //SWFS        TweenLite.to(target.swfAW14Root, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.swfAW18Root, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.swfAW17Root, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 1});        TweenLite.to(target.iconsSize.aw17.fill, GlobalAnim.TRANSISITION, {delay:delay, tint: SwatchAFX.LINK_TEAL});        TweenLite.to(target.iconsSize.aw14.fill, GlobalAnim.TRANSISITION, {tint: SwatchAFX.DESIGN_ICON_OFF});        TweenLite.to(target.iconsSize.aw18.fill, GlobalAnim.TRANSISITION, {tint: SwatchAFX.DESIGN_ICON_OFF});    }    public function activateDesign18():void {        newState = 18;        modules.removeEventHandlers();        var delay:Number = GlobalAnim.TRANSISITION + .2;        var close:TimelineLite = new TimelineLite();        close.insertMultiple([            TweenLite.to(modules.coaw14Array[1], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[7], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[4], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[0], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[2], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[5], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[6], GlobalAnim.TRANSISITION, {alpha:0}),            TweenLite.to(modules.coaw14Array[3], GlobalAnim.TRANSISITION, {alpha:0})        ],0, TweenAlign.NORMAL,.05)        //Slider switch        TweenLite.to(target.sliderAW14, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.sliderAW17, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.sliderAW18, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 1});        //ON OFF button switch        TweenLite.to(target.btnOnOffAW14, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.btnOnOffAW17, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.btnOnOffAW18, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 1});        //FEATURES        TweenLite.to(target.featureContainer14, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 0});        TweenLite.to(target.featureContainer17, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 0});        TweenLite.to(target.featureContainer18, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 1});        for (var i:int = 0, len:int = 7; i < len; i++) {            modules.coaw18Array[i].alpha = 0;            if (modules.coaw18Array[i].isExpanded) {                callNumExpanded = i;                modules.coaw18Array[i].close();            }        }        var open:TimelineLite = new TimelineLite({delay:delay, onComplete:onTimeLineComplete});        open.insertMultiple([                TweenLite.to(modules.coaw18Array[3], GlobalAnim.TRANSISITION, {alpha:1}),                TweenLite.to(modules.coaw18Array[6], GlobalAnim.TRANSISITION, {alpha:1}),                TweenLite.to(modules.coaw18Array[4], GlobalAnim.TRANSISITION, {alpha:1}),                TweenLite.to(modules.coaw18Array[2], GlobalAnim.TRANSISITION, {alpha:1}),                TweenLite.to(modules.coaw18Array[0], GlobalAnim.TRANSISITION, {alpha:1}),                TweenLite.to(modules.coaw18Array[5], GlobalAnim.TRANSISITION, {alpha:1}),                TweenLite.to(modules.coaw18Array[1], GlobalAnim.TRANSISITION, {alpha:1})        ],0, TweenAlign.NORMAL,.05)        //SWFS        TweenLite.to(target.swfAW14Root, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.swfAW17Root, GlobalAnim.TRANSISITION, {autoAlpha: 0});        TweenLite.to(target.swfAW18Root, GlobalAnim.TRANSISITION, {delay:delay, autoAlpha: 1});        TweenLite.to(target.iconsSize.aw18.fill, GlobalAnim.TRANSISITION, {delay:delay, tint: SwatchAFX.LINK_TEAL});        TweenLite.to(target.iconsSize.aw14.fill, GlobalAnim.TRANSISITION, {tint: SwatchAFX.DESIGN_ICON_OFF});        TweenLite.to(target.iconsSize.aw17.fill, GlobalAnim.TRANSISITION, {tint: SwatchAFX.DESIGN_ICON_OFF});    }    private function onTimeLineComplete():void {        TweenLite.delayedCall(.4, addModuleEventHandlers)        if (newState == 17) {            modules.coaw17Array[callNumExpanded].expand();        }        if (newState == 18) {            modules.coaw18Array[callNumExpanded].expand();        }    }    private function addModuleEventHandlers():void {        modules.addEventHandlers();        if (newState == 17) {            modules.setState(modules.getDesign17State());        }        if (newState == 18) {            modules.setState(modules.getDesign18State());        }    }    public function buildUI():void {//        trace("Bulding design 14 UI");        _callOutParentContainer = CallOutContainer.createLabelContainer(data.containerRectangle);        _callOutParentContainer.name = "design14LabelContainer";        _featureContainer14.addChild(_callOutParentContainer);        _featureContainer14.getChildByName("design14LabelContainer").x = 965 - _callOutParentContainer.width - 85;        _featureContainer14.getChildByName("design14LabelContainer").y = 0;        observerSubjectVars = {};        observerSubjectVars.sliderInitRotation = data.sliderInitRotation;        observerSubjectVars.slider = _sliderAW14;        observerSubjectVars.swfRoot = _swfRootAW14;        concreteSubject = new ConcreteCallOutSubject(observerSubjectVars);//        var callOutArray:Array = new Array();        var len:int = data.featureArray.length;        for (var i:int = 0; i < len; i++) {            data.featureArray[i].lineToTarget = _swfRootAW14[data.featureArray[i].lineToTargetName];            data.featureArray[i].container = _swfRootAW14;            data.featureArray[i].slider = _sliderAW14;            _callOutContainer = CallOutContainer.createCallOutContainer(data.featureArray[i]);            CallOutContainer.addCallOutContainerToLabelContainer(_callOutParentContainer, _callOutContainer);            data.featureArray[i].isAW = 14;            var callout:CallOut = new CallOut(data.featureArray[i]);            callout.name = "feature" + (i + 1);            modules.coaw14Array.push(callout);            _callOutContainer.addChild(callout);            concreteSubject.addObserver(callout, null);            _callOutParentContainer.parent.setChildIndex(_callOutParentContainer, _callOutParentContainer.parent.numChildren - 1);            target.setChildIndex(target.sliderAW14, target.numChildren - 1);            target.setChildIndex(target.btnOnOffAW14, target.numChildren - 1);        }        concreteSubject.tweenTo({teenTo: 0});        var vars:Object = new Object();        vars.close = true;        vars.state = "feature6";        vars.enterFrame = false;        concreteSubject.setState(vars);        //ADD ON OFF BUTTON        concreteSubject.addOnOFF(_btnOnOffAW14);    }}}